from __future__ import annotations

from pyrl.creature.creature import Creature
from pyrl.constants.colors import ColorPair
from pyrl.game_data.levels.shared_assets import construct_data, default_level_dimensions
from pyrl.game_data.tiles import PyrlTile
from pyrl.constants.level_gen import LevelGen
from pyrl.world.level import Level
from pyrl.constants.level_location import LevelLocation

def get_level(player):

    dimensions = default_level_dimensions
    charstr = (
        '################################################################################################'
        '#######################..##################.#.#.#######.....#################################.##'
        '######...##############.#.################.#.#.#.#####.####.###......#######################.@.#'
        '######.##..############.##..#############.######.#..###.###.###.####.########################.##'
        '#######.###...##.######.####.######.....##.#####.#.#.##.###.....###..###.#######################'
        '########.######...#####.#####.#####.###.###.####...##.##.##########.###.#.######################'
        '###.#####.####..#######.######.####...#.###.##########.#.##########.##.##.######################'
        '###.######.###.########.######.######.#.###.########...#.##########....##.######################'
        '###.#######.##.########.######.######.#.###.########.###.################.######################'
        '###..........##.#######.######.#####.##.....########.###.################.######################'
        '###.#######..###.######.##...#.####.################.....########.........######################'
        '###.######...####.#####.##.#...###.##############################.##############################'
        '###.#.###...######.####.##.######.###############################.###...########################'
        '####.#.##..########.###.###.####.################################.##.##........#################'
        '###.#.##.###########.##.####.##.#################################...##########.#################'
        '####.####.###########.#.#####..###############################################.#################'
        '##########.#########.##.######################################################...###############'
        '###########.#######.###.########################################################.###############'
        '############.#####.####........................................................##.##############'
        '#############.###.####.########################################################..>##############'
        '##############.#.##...##########################################################################'
        '###############.###.#.##########################################################################'
        '###############.###...##############################.....................#######################'
        '###############P...###...................................................#######################'
        '#######################################..................................#######################'
        '################################################################################################'
    )
    custom_tiles = {
        'P': PyrlTile.Stairs_Up,
        '@': PyrlTile.Floor,
    }
    custom_locations = {
        'P': LevelLocation.Passage_Up,
    }
    custom_creatures = {
        '@': Creature("The Crone", ('@', ColorPair.Purple)),
        'P': player,
    }
    level_data = custom_tiles, custom_locations, custom_creatures
    tiles, locations, creatures = construct_data(dimensions, charstr, *level_data)

    return Level(
        danger_level=1,
        generation_type=LevelGen.NoGeneration,
        tiles=tiles,
        locations=locations,
        custom_creatures=creatures,
        creature_spawning_enabled=False,
    )
